<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<!-- $Id$ -->
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="../../ug/docstyle.css">
    <title>LTPDA Method: ao/psdvfit</title>
  </head>
  <body>

    <a name="top_of_page" id="top_of_page"></a>
    <p style="font-size:1px;">&nbsp;</p>

    <table class="nav" summary="Navigation aid" border="0" width="100%" cellpadding="0" cellspacing="0">
      <tr>
        <td valign="baseline"><b>LTPDA Toolbox&trade;</b></td>
        <td><a href="../../ug/../helptoc.html">contents</a></td>
        <td valign="baseline" align="right"><a href="ao_psdconf.html"><img src="../../ug/b_prev.gif" border="0" align="bottom" alt="Method: ao/psdconf"></a>&nbsp;&nbsp;&nbsp;<a href="ao_qqplot.html"><img src="../../ug/b_next.gif" border="0" align="bottom" alt="Method: ao/qqplot"></a></td>
      </tr>
    </table>

    <h1 class="title">Method ao/psdvfit</h1>
    <hr />

<pre>  <span class="helptopic">psdvfit</span> performs a fitting loop to identify model for a psd.
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
  DESCRIPTION: <span class="helptopic">psdvfit</span> fit a partial fraction model to frequency
      response data using  the function utils.math.vcfit.
 
      The function performs a fitting loop to automatically identify model. 
      Output is a model of the spectrum. Fit function is a ratio of
      polynomials in the form of partial fraction expension.
 
               r1              rN
      f(s) = ------- + ... + -------
             s - p1          s - pN
 
      After a first fitting step, the fit can be regularized in order to
      obtain a statistically consistent model for the expected value of the
      spectrum.
      Automatic regularization is obtained checking the difference between
      the maximum of the expected gamma function and the histogram of the
      normalized spectrum (psd divided by the model frequency by
      frequency).
 
      The function can also perform a single loop without taking care of
      the stop conditions. This happens when 'AutoSearch' parameter is
      setted to 'off'.
 
      The method accepts only 1 ao at the input.
 
  CALL:         [fit,confBands,mfhMod,mfhConfBand] = <span class="helptopic">psdvfit</span>(a, pl)
 
  INPUTS:      a  - input AOs to fit.
               pl - parameter list
 
  OUTPUTS:
                fit - ao containing the fitted model.
                confBands - Lower and upper confidence band.
                mfhMod - a mfh model that can be used to evaluate the model
                on a different frequency grid.
                mfhConfBand - mfh models for the confidence bands.
 
 
  Note: Gamma function assumption for the spectrum is strictly true only with
      Gaussian distributed noise (time series). In case the noise in time
      domain is non-Gaussian the Gamma is an approximation based on the
      norilizing properties of the fft. Even if noise series is
      non-Gaussian, real and imaginary part of the fft tend to a Gaussian
      because are the result of the sum of many terms.
 
 
  EXAMPLES:
 
    % Fitting parameter list
    pl_fit = plist(...
    'maxiter',50,...
    'minorder',9,...
    'maxorder',20,...
    'FITTOL',1.7,...
    'Plot','on');
 
    % Do fit
    [fit,confBands,mfhMod,mfhConfBand] = <span class="helptopic">psdvfit</span>(a, pl_fit);
 
 
  <a href="ao_psdvfit.html#down">Parameters Description</a>
 
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</pre>

    <!-- =====        Striped 4x2 table: Begin        ==== -->
    <!-- ===== Created by docHelper.htmlAddStripedTable ===== -->
    <div class="sectiontitle"></div>
    <table cellspacing="0" class="body" cellpadding="2" border="0" width="60%">
      <colgroup>
        <col width="30%"/>
        <col width="70%"/>
      </colgroup>
      <thead>
        <tr valign="top">
          <th class="categorylist">Method Details</th>
          <th class="categorylist"></th>
        </tr>
      </thead>
      <tbody>
        <tr valign="top">
          <td bgcolor="#f3f4f5">Access</td>
          <td bgcolor="#f3f4f5">public</td>
        </tr>
        <tr valign="top">
          <td bgcolor="#ffffff">Defining Class</td>
          <td bgcolor="#ffffff">ao</td>
        </tr>
        <tr valign="top">
          <td bgcolor="#f3f4f5">Sealed</td>
          <td bgcolor="#f3f4f5">0</td>
        </tr>
        <tr valign="top">
          <td bgcolor="#ffffff">Static</td>
          <td bgcolor="#ffffff">0</td>
        </tr>
      </tbody>
    </table>
    <!-- ===== Striped 4x2 table: End ==== -->

    <a name="top_of_page" id="top_of_page"></a>
    <h2>Parameter Description</h2>    <a name="down" id="down"></a>

    <!-- Link-Table of the sets -->
    <table border="0" cellpadding="4" cellspacing="0" class="pagenavtable">
      <tr><th>Sets for this method &#8230;</th></tr>
        <tr><td><a href="#1">Default</a></td></tr>
    </table>

    <a name="1"></a>
    <!-- Parameter List Table: Default -->
    <p>
      <table cellspacing="0" class="body" cellpadding="4" summary="" width="100%" border="2">
        <colgroup>
          <col width="15%"/>
          <col width="20%"/>
          <col width="20%"/>
          <col width="45%"/>
        </colgroup>
        <thead>
        	<tr valign="top">
        		<th bgcolor="#B9C6DD" colspan="4"><h3>Default</h3></th>
      	  </tr>
        	<tr valign="top">
        		<td bgcolor="#B9C6DD" colspan="4"><i>no description</i></td>
      	  </tr>
        	<tr valign="top">
      	  	<th bgcolor="#D7D7D7">Key</th>
        		<th bgcolor="#D7D7D7">Default Value</th>
        		<th bgcolor="#D7D7D7">Options</th>
      	  	<th bgcolor="#D7D7D7">Description</th>
        	</tr>
        </thead>
        <tbody>
          <tr valign="top" ><td align="center" bgcolor="#CCCCFF" colspan="4">psdvfit</td></tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">AUTOSEARCH</td>
            <td bgcolor="#F2F2F2">'on'</td>
            <td bgcolor="#F2F2F2"><ul><li><font color="#1111FF">'on'</font></li><li><font color="#1111FF">'off'</font></li></ul></td>
            <td bgcolor="#F2F2F2">'on': Parform a full automatic search for the<br>transfer function order. The fitting<br>procedure will stop when stop conditions<br>defined are satisfied.<br>'off': Perform a fitting loop as long as the<br>number of iteration reach 'maxiter'. The order<br>of the fitting function will be that<br>specified in 'minorder'.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">MAXITER</td>
            <td bgcolor="#F2F2F2">50</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">Maximum number of iterations in fit routine.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">MINORDER</td>
            <td bgcolor="#F2F2F2">2</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">Minimum order to fit with.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">MAXORDER</td>
            <td bgcolor="#F2F2F2">20</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">Maximum order to fit with.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">FITTOL</td>
            <td bgcolor="#F2F2F2">2</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">Fit tolerance. Check the maximu spread on the whitened spectrum.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">PLOT</td>
            <td bgcolor="#F2F2F2">'off'</td>
            <td bgcolor="#F2F2F2"><ul><li><font color="#1111FF">'on'</font></li><li><font color="#1111FF">'off'</font></li></ul></td>
            <td bgcolor="#F2F2F2">Plot results of each fitting step.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">CHECKPROGRESS</td>
            <td bgcolor="#F2F2F2">'off'</td>
            <td bgcolor="#F2F2F2"><ul><li><font color="#1111FF">'on'</font></li><li><font color="#1111FF">'off'</font></li></ul></td>
            <td bgcolor="#F2F2F2">Display the status of the fit iteration.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">DOWNSAMPLESPECTRUM</td>
            <td bgcolor="#F2F2F2">0</td>
            <td bgcolor="#F2F2F2"><ul><li><font color="#1111FF">0</font></li><li><font color="#1111FF">1</font></li></ul></td>
            <td bgcolor="#F2F2F2">Decide to downsample the spectrum in order to have independent bins.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">DOWNSAMPLEBINS</td>
            <td bgcolor="#F2F2F2">3</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">Number of bins to skip in order to get independence.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">REGULARIZE</td>
            <td bgcolor="#F2F2F2">1</td>
            <td bgcolor="#F2F2F2"><ul><li><font color="#1111FF">1</font></li><li><font color="#1111FF">0</font></li></ul></td>
            <td bgcolor="#F2F2F2">Regularize data in order to have a statistically consistent model.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">REGULARIZECOEFF</td>
            <td bgcolor="#F2F2F2">[]</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">Regularization coefficient. Leave it empty if you want to do it automatically.</td>
          </tr>
        </tbody>
      </table>
      <p>
      <table cellpadding="4">
        <thead>
        	<tr valign="top">
        		<th bgcolor="#FFEE99"><h3>Example</h3></th>
      	  </tr>
        </thead>
        <tbody>
          <tr bgcolor="#FFEE99"><td>plist('AUTOSEARCH', 'on', 'MAXITER', [50], 'MINORDER', [2], 'MAXORDER', [20], 'FITTOL', [2], 'PLOT', 'off', 'CHECKPROGRESS', 'off', 'DOWNSAMPLESPECTRUM', [false], 'DOWNSAMPLEBINS', [3], 'REGULARIZE', [true], 'REGULARIZECOEFF', [[]])</td></tr>
        </tbody>
      </table>
      </p>
      <!-- ===== Back to top ===== -->
      <a href="#top_of_page">
        <img src="../../ug/doc_to_top_up.gif" border="0" align="bottom" alt="back to top"/>
        back to top
      </a>
    </p>

    <p><!-- Table of the minfo object -->
      <table cellspacing="0" class="body" cellpadding="2" border="0" width="60%">
        <colgroup>
          <col width="25%"/>
          <col width="75%"/>
        </colgroup>
        <thead>
          <tr valign="top">
            <th class="categorylist" colspan="2">Some information of the method ao/psdvfit are listed below:</th>
          </tr>
        </thead>
        <tbody>
          <!-- Property: 'mclass' -->
          <tr valign="top">
            <td bgcolor="#f3f4f5">Class name</td>
            <td bgcolor="#f3f4f5">ao</td>
          </tr>
          <!-- Property: 'mname' -->
          <tr valign="top">
            <td bgcolor="#ffffff">Method name</td>
            <td bgcolor="#ffffff">psdvfit</td>
          </tr>
          <!-- Property: 'mcategory' -->
          <tr valign="top">
            <td bgcolor="#f3f4f5">Category</td>
            <td bgcolor="#f3f4f5">Signal Processing</td>
          </tr>
          <!-- Property: 'mpackage' -->
          <tr valign="top">
            <td bgcolor="#ffffff">Package name</td>
            <td bgcolor="#ffffff">ltpda</td>
          </tr>
          <!-- Property: 'modifier' -->
          <tr valign="top">
            <td bgcolor="#f3f4f5">Can be used as modifier</td>
            <td bgcolor="#f3f4f5">0</td>
          </tr>
          <!-- Property: 'supportedNumTypes' -->
          <tr valign="top">
            <td bgcolor="#ffffff">Supported numeric types</td>
            <td bgcolor="#ffffff">{'double'}</td>
          </tr>
        </tbody>
      </table>
    </p>


    <br>
    <br>
    <table class="nav" summary="Navigation aid" border="0" width="100%" cellpadding="0" cellspacing="0">
      <tr valign="top">
        <td align="left" width="20"><a href="ao_psdconf.html"><img src="../../ug/b_prev.gif" border="0" align="bottom" alt="Method: ao/psdconf"></a>&nbsp;</td>
        <td align="left">Method: ao/psdconf</td>
        <td>&nbsp;</td>
        <td align="right">Method: ao/qqplot</td>
        <td align="right" width="20"><a href="ao_qqplot.html"><img src="../../ug/b_next.gif" border="0" align="bottom" alt="Method: ao/qqplot"></a></td>
      </tr>
    </table>

    <br/>
    <p class="copy">&copy;LTP Team</p>

   </body>
</html>

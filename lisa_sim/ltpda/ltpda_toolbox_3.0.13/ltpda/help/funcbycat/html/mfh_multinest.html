<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<!-- $Id$ -->
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="../../ug/docstyle.css">
    <title>LTPDA Method: mfh/multinest</title>
  </head>
  <body>

    <a name="top_of_page" id="top_of_page"></a>
    <p style="font-size:1px;">&nbsp;</p>

    <table class="nav" summary="Navigation aid" border="0" width="100%" cellpadding="0" cellspacing="0">
      <tr>
        <td valign="baseline"><b>LTPDA Toolbox&trade;</b></td>
        <td><a href="../../ug/../helptoc.html">contents</a></td>
        <td valign="baseline" align="right"><a href="mfh_loglikelihood.html"><img src="../../ug/b_prev.gif" border="0" align="bottom" alt="Method: mfh/loglikelihood"></a>&nbsp;&nbsp;&nbsp;<a href="mfh_paramCovMat.html"><img src="../../ug/b_next.gif" border="0" align="bottom" alt="Method: mfh/paramCovMat"></a></td>
      </tr>
    </table>

    <h1 class="title">Method mfh/multinest</h1>
    <hr />

<pre>  <SPAN CLASS="HELPTOPIC">MULTINEST</SPAN>.M
 
  <span class="helptopic">multinest</span> is a Bayesian inference tool which calculates the evidence and 
  explores the parameter space which may contain multiple posterior modes 
  and pronounced (curving) degeneracies in moderately high dimensions. 
 
  For more information about the algorithm see arXiv:0809.3437 
 
  CALL:
          p = <span class="helptopic">multinest</span>(c, plist);
 
  where     p - pest object containing the results of the fit
            c - a cost function. Must be a mfh object
        plist - a given plist    
 
 
  USE OF PRIORS:
  
    The prior should be a cell array with each cell containing five values:
    
    prior = { parameter_name (string); prior_type (string); prior_specs, prior_behaviour (string)};
      
    where 
    prior_type      -&gt; 'uniform', 'gaussian' of 'jeffreys'
    prior_specs     -&gt; prior specifications: min val, max val, mean, sigma
    prior_behaviour -&gt; 'reflect' - if the parameters reflect off the boundaries
                       'cyclic'  - if the parameter space is cyclic
                       'fixed'   - if the parameters have fixed boundaries
                       ''        - for gaussian priors
 
    e.g., prior = {'h0',  'uniform',  0, 1,    'reflect';
                   'r',   'gaussian', 0, 5,    '';
                   'phi', 'uniform',  0, 2*pi, 'cyclic'};
 
 
 
 
  EXAMPLE:
  
        % Create some data and make a data set to fit
        fs    = 1;
        nsecs = 2e3;
        B1 = ao(plist('tsfcn', 'randn(size(t))', 'fs', fs, 'nsecs', nsecs, 'yunits', 'T'));
        B2 = ao(plist('tsfcn', 'randn(size(t))', 'fs', fs, 'nsecs', nsecs, 'yunits', 'T'));
        B3 = ao(plist('tsfcn', 'randn(size(t))', 'fs', fs, 'nsecs', nsecs, 'yunits', 'T'));
        n  = ao(plist('tsfcn', 'randn(size(t))', 'fs', fs, 'nsecs', nsecs, 'yunits', 'm'));
  
        % Noise of the experiment
        n_exp = ao(plist('tsfcn', 'randn(size(t))', 'fs', fs, 'nsecs', 10*nsecs, 'yunits', 'm'));
  
        % Combination parameters
        c = [ao(1,plist('yunits','m/T')) ao(2,plist('yunits','m/T')) ao(3,plist('yunits','m T^-1'))];
  
        % Define here the data to fit
        y = c(1)*B1 + c(2)*B2 + c(3)*B3 + n;
        y.simplifyYunits;
  
        % Get a fit for c with a linear fitter
        p_s = lscov(B1, B2, B3, y);
        p_s.setName('lscov');
  
        % do linear combination: using lincom
        yfit = lincom(B1, B2, B3, p_s);
        yfit.simplifyYunits;
  
        % Create a MFH model of the above data analysis
        mdl = mfh(plist(...
                        'name',             'temp',...
                        'built-in',         'custom',...      
                        'numeric',          true,...  
                        'params',           p_s,...
                        'func',             'C1.*B1 + C2.*B2 + C3.*B3',...  
                        'constants',        {'B1','B2','B3'},...
                        'constant objects', {B1,B2,B3}));
  
        % Define a log-Likelihood function
        llh = mfh(plist('built-in',     'loglikelihood', ...
                        'version',      'td core',...
                        'name',         'Gaussian td',...
                        'model',        mdl,...        
                        'data',         y,... 
                        'p0',           p_s));
  
        llh.setName('LLH');
  
        %% Run <span class="helptopic">multinest</span>    
 
        % Define the prior
        prior = {'C1', 'uniform', -1, 3, 'fixed'; ...
                 'C2', 'uniform', 0, 5,  'fixed'; ...
                 'C3', 'uniform', 1, 8,  'fixed'};
  
        p = <span class="helptopic">multinest</span>(llh, plist('p0',    p_s,...
                                 'Nlive', 300, ...
                                 'prior', prior));             
        
        % Plot the parameter PDFs
        p.mcmcPlot(plist('chains',0,'plot fit curves',0,'nbins',60,...
                         'burnin',2, 'pdfs', true,'hist type', 'stairs', ...
                         'plot cumsum',0,'plotmatrix',true))
 
        % Compare
        table(p_s, p)
 
 
 
 
 
  This function is an LTPDA wrapper of the Matlab version of the <span Class="helptopic">multinest</span>
  algorithm. The original functions are copied here verbatim, apart from
  minor changes needed to support the LTPDA environment. The original code
  is available here:
 
  https://ccpforge.cse.rl.ac.uk/gf/project/<span class="helptopic">multinest</span>/
  https://github.com/mattpitkin/matlabmultinest
 
  Copyright (C) 2012 Matthew Pitkin &amp; Joseph Romano
 
  Translation to LTPDA by NK 2017
 </pre>

    <!-- =====        Striped 4x2 table: Begin        ==== -->
    <!-- ===== Created by docHelper.htmlAddStripedTable ===== -->
    <div class="sectiontitle"></div>
    <table cellspacing="0" class="body" cellpadding="2" border="0" width="60%">
      <colgroup>
        <col width="30%"/>
        <col width="70%"/>
      </colgroup>
      <thead>
        <tr valign="top">
          <th class="categorylist">Method Details</th>
          <th class="categorylist"></th>
        </tr>
      </thead>
      <tbody>
        <tr valign="top">
          <td bgcolor="#f3f4f5">Access</td>
          <td bgcolor="#f3f4f5">public</td>
        </tr>
        <tr valign="top">
          <td bgcolor="#ffffff">Defining Class</td>
          <td bgcolor="#ffffff">mfh</td>
        </tr>
        <tr valign="top">
          <td bgcolor="#f3f4f5">Sealed</td>
          <td bgcolor="#f3f4f5">0</td>
        </tr>
        <tr valign="top">
          <td bgcolor="#ffffff">Static</td>
          <td bgcolor="#ffffff">0</td>
        </tr>
      </tbody>
    </table>
    <!-- ===== Striped 4x2 table: End ==== -->

    <a name="top_of_page" id="top_of_page"></a>
    <h2>Parameter Description</h2>    <a name="down" id="down"></a>

    <!-- Link-Table of the sets -->
    <table border="0" cellpadding="4" cellspacing="0" class="pagenavtable">
      <tr><th>Sets for this method &#8230;</th></tr>
        <tr><td><a href="#1">Default</a></td></tr>
    </table>

    <a name="1"></a>
    <!-- Parameter List Table: Default -->
    <p>
      <table cellspacing="0" class="body" cellpadding="4" summary="" width="100%" border="2">
        <colgroup>
          <col width="15%"/>
          <col width="20%"/>
          <col width="20%"/>
          <col width="45%"/>
        </colgroup>
        <thead>
        	<tr valign="top">
        		<th bgcolor="#B9C6DD" colspan="4"><h3>Default</h3></th>
      	  </tr>
        	<tr valign="top">
        		<td bgcolor="#B9C6DD" colspan="4"><i>no description</i></td>
      	  </tr>
        	<tr valign="top">
      	  	<th bgcolor="#D7D7D7">Key</th>
        		<th bgcolor="#D7D7D7">Default Value</th>
        		<th bgcolor="#D7D7D7">Options</th>
      	  	<th bgcolor="#D7D7D7">Description</th>
        	</tr>
        </thead>
        <tbody>
          <tr valign="top" ><td align="center" bgcolor="#CCCCFF" colspan="4">multinest</td></tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">P0</td>
            <td bgcolor="#F2F2F2">[]</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">A pest object containing information about the parameters (parameter names and units).</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">VERBOSE</td>
            <td bgcolor="#F2F2F2">1</td>
            <td bgcolor="#F2F2F2"><ul><li><font color="#1111FF">1</font></li><li><font color="#1111FF">0</font></li></ul></td>
            <td bgcolor="#F2F2F2">True-False flag for printing information on screen.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">DEBUG</td>
            <td bgcolor="#F2F2F2">0</td>
            <td bgcolor="#F2F2F2"><ul><li><font color="#1111FF">0</font></li><li><font color="#1111FF">1</font></li></ul></td>
            <td bgcolor="#F2F2F2">True-False flag for debuging purposes.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">NLIVE</td>
            <td bgcolor="#F2F2F2">[]</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">The number of live points for the Nested Sampling algorithm</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">TOL</td>
            <td bgcolor="#F2F2F2">0.001</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">The tolerance value for the stoping criteria</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">PRIOR</td>
            <td bgcolor="#F2F2F2">''</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">The prior densities of the parameters. See example for usage. Currently only handles Gaussian and Uniform priors. </td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">EXTRAPARAMS</td>
            <td bgcolor="#F2F2F2">''</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">TBD</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">OTHER OPTIONS</td>
            <td bgcolor="#F2F2F2">{} [0x0]</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">A cell array of other specialised options to be passed to the algorithm. For more information check the Matlab Multinest examples.</td>
          </tr>
        </tbody>
      </table>
      <p>
      <table cellpadding="4">
        <thead>
        	<tr valign="top">
        		<th bgcolor="#FFEE99"><h3>Example</h3></th>
      	  </tr>
        </thead>
        <tbody>
          <tr bgcolor="#FFEE99"><td>plist('P0', [[]], 'VERBOSE', [true], 'DEBUG', [false], 'NLIVE', [[]], 'TOL', [0.001], 'PRIOR', '', 'EXTRAPARAMS', '', 'OTHER OPTIONS', cell(0,0))</td></tr>
        </tbody>
      </table>
      </p>
      <!-- ===== Back to top ===== -->
      <a href="#top_of_page">
        <img src="../../ug/doc_to_top_up.gif" border="0" align="bottom" alt="back to top"/>
        back to top
      </a>
    </p>

    <p><!-- Table of the minfo object -->
      <table cellspacing="0" class="body" cellpadding="2" border="0" width="60%">
        <colgroup>
          <col width="25%"/>
          <col width="75%"/>
        </colgroup>
        <thead>
          <tr valign="top">
            <th class="categorylist" colspan="2">Some information of the method mfh/multinest are listed below:</th>
          </tr>
        </thead>
        <tbody>
          <!-- Property: 'mclass' -->
          <tr valign="top">
            <td bgcolor="#f3f4f5">Class name</td>
            <td bgcolor="#f3f4f5">mfh</td>
          </tr>
          <!-- Property: 'mname' -->
          <tr valign="top">
            <td bgcolor="#ffffff">Method name</td>
            <td bgcolor="#ffffff">multinest</td>
          </tr>
          <!-- Property: 'mcategory' -->
          <tr valign="top">
            <td bgcolor="#f3f4f5">Category</td>
            <td bgcolor="#f3f4f5">Signal Processing</td>
          </tr>
          <!-- Property: 'mpackage' -->
          <tr valign="top">
            <td bgcolor="#ffffff">Package name</td>
            <td bgcolor="#ffffff">ltpda</td>
          </tr>
          <!-- Property: 'modifier' -->
          <tr valign="top">
            <td bgcolor="#f3f4f5">Can be used as modifier</td>
            <td bgcolor="#f3f4f5">1</td>
          </tr>
          <!-- Property: 'supportedNumTypes' -->
          <tr valign="top">
            <td bgcolor="#ffffff">Supported numeric types</td>
            <td bgcolor="#ffffff">{'double'}</td>
          </tr>
        </tbody>
      </table>
    </p>


    <br>
    <br>
    <table class="nav" summary="Navigation aid" border="0" width="100%" cellpadding="0" cellspacing="0">
      <tr valign="top">
        <td align="left" width="20"><a href="mfh_loglikelihood.html"><img src="../../ug/b_prev.gif" border="0" align="bottom" alt="Method: mfh/loglikelihood"></a>&nbsp;</td>
        <td align="left">Method: mfh/loglikelihood</td>
        <td>&nbsp;</td>
        <td align="right">Method: mfh/paramCovMat</td>
        <td align="right" width="20"><a href="mfh_paramCovMat.html"><img src="../../ug/b_next.gif" border="0" align="bottom" alt="Method: mfh/paramCovMat"></a></td>
      </tr>
    </table>

    <br/>
    <p class="copy">&copy;LTP Team</p>

   </body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<!-- $Id$ -->
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="../../ug/docstyle.css">
    <title>LTPDA Method: ao/tdfit</title>
  </head>
  <body>

    <a name="top_of_page" id="top_of_page"></a>
    <p style="font-size:1px;">&nbsp;</p>

    <table class="nav" summary="Navigation aid" border="0" width="100%" cellpadding="0" cellspacing="0">
      <tr>
        <td valign="baseline"><b>LTPDA Toolbox&trade;</b></td>
        <td><a href="../../ug/../helptoc.html">contents</a></td>
        <td valign="baseline" align="right"><a href="ao_svd_fit.html"><img src="../../ug/b_prev.gif" border="0" align="bottom" alt="Method: ao/svd_fit"></a>&nbsp;&nbsp;&nbsp;<a href="ao_tfe.html"><img src="../../ug/b_next.gif" border="0" align="bottom" alt="Method: ao/tfe"></a></td>
      </tr>
    </table>

    <h1 class="title">Method ao/tdfit</h1>
    <hr />

<pre>  <SPAN CLASS="HELPTOPIC">TDFIT</SPAN> fit a set of smodels to a set of input and output signals..
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
  DESCRIPTION: <SPAN CLASS="HELPTOPIC">TDFIT</SPAN> fit a set of smodels to a set of input and output signals. 
  
 
  CALL:        b = <span class="helptopic">tdfit</span>(outputs, pl)
 
  INPUTS:      outputs  - the AOs representing the outputs of a system.
               pl       - parameter list (see below)
 
  OUTPUTs:     b  - a pest object containing the best-fit parameters,
                    goodness-of-fit reduced chi-squared, fit degree-of-freedom
                    covariance matrix and uncertainties. Additional
                    quantities, like the Information Matrix, are contained 
                    within the procinfo. The best-fit model can be evaluated
                    from pest\eval.
 
  <a href="ao_tdfit.html#down">Parameters Description</a>
 
  EXAMPLES:
 
  % 1) Sine-wave stimulus of a simple system
  
    % Sine-wave data
    data = ao(plist('tsfcn', 'sin(2*pi*3*t) + 0.01*randn(size(t))', 'fs', 100, 'nsecs', 10));
    data.setName;
  
    % System filter
    pzm = pzmodel(1, 1, 10);
    f = miir(pzm);
  
    % Make output signal
    dataf = filter(data, f);
    dataf.setName;
  
    % fit model to output
    mdl = smodel('(a.*(b + 2*pi*i*f)) ./ (b*(a + 2*pi*i*f))');
    mdl.setParams({'a', 'b'}, {2*pi 10*2*pi});
    mdl.setXvar('f');
    params = <span class="helptopic">tdfit</span>(dataf, plist('inputs', data, 'models', mdl, 'P0', [1 1]));
  
    % Evaluate fit
    mdl.setValues(params);
    BestModel = fftfilt(data, mdl);
    BestModel.setName;
    iplot(data, dataf, BestModel, plist('linestyles', {'-', '-', '--'}))
  
    % recovered parameters (in Hz)
    params.y/2/pi
  
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</pre>

    <!-- =====        Striped 4x2 table: Begin        ==== -->
    <!-- ===== Created by docHelper.htmlAddStripedTable ===== -->
    <div class="sectiontitle"></div>
    <table cellspacing="0" class="body" cellpadding="2" border="0" width="60%">
      <colgroup>
        <col width="30%"/>
        <col width="70%"/>
      </colgroup>
      <thead>
        <tr valign="top">
          <th class="categorylist">Method Details</th>
          <th class="categorylist"></th>
        </tr>
      </thead>
      <tbody>
        <tr valign="top">
          <td bgcolor="#f3f4f5">Access</td>
          <td bgcolor="#f3f4f5">public</td>
        </tr>
        <tr valign="top">
          <td bgcolor="#ffffff">Defining Class</td>
          <td bgcolor="#ffffff">ao</td>
        </tr>
        <tr valign="top">
          <td bgcolor="#f3f4f5">Sealed</td>
          <td bgcolor="#f3f4f5">0</td>
        </tr>
        <tr valign="top">
          <td bgcolor="#ffffff">Static</td>
          <td bgcolor="#ffffff">0</td>
        </tr>
      </tbody>
    </table>
    <!-- ===== Striped 4x2 table: End ==== -->

    <a name="top_of_page" id="top_of_page"></a>
    <h2>Parameter Description</h2>    <a name="down" id="down"></a>

    <!-- Link-Table of the sets -->
    <table border="0" cellpadding="4" cellspacing="0" class="pagenavtable">
      <tr><th>Sets for this method &#8230;</th></tr>
        <tr><td><a href="#1">Default</a></td></tr>
    </table>

    <a name="1"></a>
    <!-- Parameter List Table: Default -->
    <p>
      <table cellspacing="0" class="body" cellpadding="4" summary="" width="100%" border="2">
        <colgroup>
          <col width="15%"/>
          <col width="20%"/>
          <col width="20%"/>
          <col width="45%"/>
        </colgroup>
        <thead>
        	<tr valign="top">
        		<th bgcolor="#B9C6DD" colspan="4"><h3>Default</h3></th>
      	  </tr>
        	<tr valign="top">
        		<td bgcolor="#B9C6DD" colspan="4"><i>no description</i></td>
      	  </tr>
        	<tr valign="top">
      	  	<th bgcolor="#D7D7D7">Key</th>
        		<th bgcolor="#D7D7D7">Default Value</th>
        		<th bgcolor="#D7D7D7">Options</th>
      	  	<th bgcolor="#D7D7D7">Description</th>
        	</tr>
        </thead>
        <tbody>
          <tr valign="top" ><td align="center" bgcolor="#CCCCFF" colspan="4">tdfit</td></tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">INPUTS</td>
            <td bgcolor="#F2F2F2">[]</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">An array of input AOs, one per each experiment.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">MODELS</td>
            <td bgcolor="#F2F2F2">[]</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">An array of transfer function SMODELs.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">PADRATIO</td>
            <td bgcolor="#F2F2F2">1</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">PadRatio is defined as the ratio between the number of zero-pad points and the data length.<br>Define how much to zero-pad data after the signal.<br>Being <tt>tdfit</tt> a fft-based algorithm, no zero-padding might bias the estimation, therefore it is strongly suggested to do that.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">WHFLTS</td>
            <td bgcolor="#F2F2F2">[]</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">An array of FILTERBANKs containing the whitening filters per each output AO.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">PNAMES</td>
            <td bgcolor="#F2F2F2">{} [0x0]</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">A cell-array of parameter names to fit.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">P0</td>
            <td bgcolor="#F2F2F2">[]</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">An array of starting guesses for the parameters.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">LB</td>
            <td bgcolor="#F2F2F2">[]</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">Lower bounds for the parameters.<br>This improves convergency. Mandatory for Monte Carlo.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">UB</td>
            <td bgcolor="#F2F2F2">[]</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">Upper bounds for the parameters.<br>This improves the convergency. Mandatory for Monte Carlo.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">ALGORITHM</td>
            <td bgcolor="#F2F2F2">'fminsearch'</td>
            <td bgcolor="#F2F2F2"><ul><li><font color="#1111FF">'fminsearch'</font></li><li><font color="#1111FF">'fminunc'</font></li><li><font color="#1111FF">'fmincon'</font></li><li><font color="#1111FF">'patternsearch'</font></li><li><font color="#1111FF">'ga'</font></li><li><font color="#1111FF">'simulannealbnd'</font></li></ul></td>
            <td bgcolor="#F2F2F2">A string defining the fitting algorithm.<br><tt>fminunc</tt>, <tt>fmincon</tt> require 'Optimization Toolbox' to be installed.<br><tt>patternsearch</tt>, <tt>ga</tt>, <tt>simulannealbnd</tt> require 'Genetic Algorithm and Direct Search' to be installed.<br></td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">OPTSET</td>
            <td bgcolor="#F2F2F2">''</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">An optimisation structure to pass to the fitting algorithm.<br>See <tt>fminsearch</tt>, <tt>fminunc</tt>, <tt>fmincon</tt>, <tt>optimset</tt>, for details.<br>See <tt>patternsearch</tt>, <tt>psoptimset</tt>, for details.<br>See <tt>ga</tt>, <tt>gaoptimset</tt>, for details.<br>See <tt>simulannealbnd</tt>, <tt>saoptimset</tt>, for details.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">SYMDIFF</td>
            <td bgcolor="#F2F2F2">0</td>
            <td bgcolor="#F2F2F2"><ul><li><font color="#1111FF">0</font></li><li><font color="#1111FF">1</font></li></ul></td>
            <td bgcolor="#F2F2F2">Use symbolic derivatives or not. Only for gradient-based algorithm or for LinUnc option.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">DIFFORDER</td>
            <td bgcolor="#F2F2F2">1</td>
            <td bgcolor="#F2F2F2"><ul><li><font color="#1111FF">1</font></li><li><font color="#1111FF">2</font></li></ul></td>
            <td bgcolor="#F2F2F2">Symbolic derivative order. Only for SymDiff option.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">FITUNC</td>
            <td bgcolor="#F2F2F2">1</td>
            <td bgcolor="#F2F2F2"><ul><li><font color="#1111FF">1</font></li><li><font color="#1111FF">0</font></li></ul></td>
            <td bgcolor="#F2F2F2">Fit parameter uncertainties or not.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">UNCMTD</td>
            <td bgcolor="#F2F2F2">'hessian'</td>
            <td bgcolor="#F2F2F2"><ul><li><font color="#1111FF">'hessian'</font></li><li><font color="#1111FF">'jacobian'</font></li></ul></td>
            <td bgcolor="#F2F2F2">Choose the uncertainties estimation method.<br>For multi-channel fitting <tt>hessian</tt> is mandatory.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">LINUNC</td>
            <td bgcolor="#F2F2F2">1</td>
            <td bgcolor="#F2F2F2"><ul><li><font color="#1111FF">1</font></li><li><font color="#1111FF">0</font></li></ul></td>
            <td bgcolor="#F2F2F2">Force linear symbolic uncertainties.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">GRADSEARCH</td>
            <td bgcolor="#F2F2F2">0</td>
            <td bgcolor="#F2F2F2"><ul><li><font color="#1111FF">0</font></li><li><font color="#1111FF">1</font></li></ul></td>
            <td bgcolor="#F2F2F2">Do a preliminary gradient-based search using the BFGS Quasi-Newton method.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">MONTECARLO</td>
            <td bgcolor="#F2F2F2">0</td>
            <td bgcolor="#F2F2F2"><ul><li><font color="#1111FF">0</font></li><li><font color="#1111FF">1</font></li></ul></td>
            <td bgcolor="#F2F2F2">Do a Monte Carlo search in the parameter space.<br>Useful when dealing with high multiplicity of local minima. May be computer-expensive.<br>Note that, if used, P0 will be ignored. It also requires to define LB and UB.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">NPOINTS</td>
            <td bgcolor="#F2F2F2">100000</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">Set the number of points in the parameter space to be extracted.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">NOPTIMS</td>
            <td bgcolor="#F2F2F2">10</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">Set the number of optimizations to be performed after the Monte Carlo.</td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">SINGLEINPUTSINGLEOUTPUT</td>
            <td bgcolor="#F2F2F2">0</td>
            <td bgcolor="#F2F2F2"><ul><li><font color="#1111FF">0</font></li><li><font color="#1111FF">1</font></li></ul></td>
            <td bgcolor="#F2F2F2">Specify whether the model should be considered as Single-Input/Single-Output model. This is for performance.</td>
          </tr>
        </tbody>
      </table>
      <p>
      <table cellpadding="4">
        <thead>
        	<tr valign="top">
        		<th bgcolor="#FFEE99"><h3>Example</h3></th>
      	  </tr>
        </thead>
        <tbody>
          <tr bgcolor="#FFEE99"><td>plist('INPUTS', [[]], 'MODELS', [[]], 'PADRATIO', [1], 'WHFLTS', [[]], 'PNAMES', cell(0,0), 'P0', [[]], 'LB', [[]], 'UB', [[]], 'ALGORITHM', 'fminsearch', 'OPTSET', '', 'SYMDIFF', [false], 'DIFFORDER', [1], 'FITUNC', [true], 'UNCMTD', 'hessian', 'LINUNC', [true], 'GRADSEARCH', [false], 'MONTECARLO', [false], 'NPOINTS', [100000], 'NOPTIMS', [10], 'SINGLEINPUTSINGLEOUTPUT', [false])</td></tr>
        </tbody>
      </table>
      </p>
      <!-- ===== Back to top ===== -->
      <a href="#top_of_page">
        <img src="../../ug/doc_to_top_up.gif" border="0" align="bottom" alt="back to top"/>
        back to top
      </a>
    </p>

    <p><!-- Table of the minfo object -->
      <table cellspacing="0" class="body" cellpadding="2" border="0" width="60%">
        <colgroup>
          <col width="25%"/>
          <col width="75%"/>
        </colgroup>
        <thead>
          <tr valign="top">
            <th class="categorylist" colspan="2">Some information of the method ao/tdfit are listed below:</th>
          </tr>
        </thead>
        <tbody>
          <!-- Property: 'mclass' -->
          <tr valign="top">
            <td bgcolor="#f3f4f5">Class name</td>
            <td bgcolor="#f3f4f5">ao</td>
          </tr>
          <!-- Property: 'mname' -->
          <tr valign="top">
            <td bgcolor="#ffffff">Method name</td>
            <td bgcolor="#ffffff">tdfit</td>
          </tr>
          <!-- Property: 'mcategory' -->
          <tr valign="top">
            <td bgcolor="#f3f4f5">Category</td>
            <td bgcolor="#f3f4f5">Signal Processing</td>
          </tr>
          <!-- Property: 'mpackage' -->
          <tr valign="top">
            <td bgcolor="#ffffff">Package name</td>
            <td bgcolor="#ffffff">ltpda</td>
          </tr>
          <!-- Property: 'modifier' -->
          <tr valign="top">
            <td bgcolor="#f3f4f5">Can be used as modifier</td>
            <td bgcolor="#f3f4f5">0</td>
          </tr>
          <!-- Property: 'supportedNumTypes' -->
          <tr valign="top">
            <td bgcolor="#ffffff">Supported numeric types</td>
            <td bgcolor="#ffffff">{'double'}</td>
          </tr>
        </tbody>
      </table>
    </p>


    <br>
    <br>
    <table class="nav" summary="Navigation aid" border="0" width="100%" cellpadding="0" cellspacing="0">
      <tr valign="top">
        <td align="left" width="20"><a href="ao_svd_fit.html"><img src="../../ug/b_prev.gif" border="0" align="bottom" alt="Method: ao/svd_fit"></a>&nbsp;</td>
        <td align="left">Method: ao/svd_fit</td>
        <td>&nbsp;</td>
        <td align="right">Method: ao/tfe</td>
        <td align="right" width="20"><a href="ao_tfe.html"><img src="../../ug/b_next.gif" border="0" align="bottom" alt="Method: ao/tfe"></a></td>
      </tr>
    </table>

    <br/>
    <p class="copy">&copy;LTP Team</p>

   </body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<!-- $Id$ -->
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="../../ug/docstyle.css">
    <title>LTPDA Method: ao/linfit</title>
  </head>
  <body>

    <a name="top_of_page" id="top_of_page"></a>
    <p style="font-size:1px;">&nbsp;</p>

    <table class="nav" summary="Navigation aid" border="0" width="100%" cellpadding="0" cellspacing="0">
      <tr>
        <td valign="baseline"><b>LTPDA Toolbox&trade;</b></td>
        <td><a href="../../ug/../helptoc.html">contents</a></td>
        <td valign="baseline" align="right"><a href="ao_linedetect.html"><img src="../../ug/b_prev.gif" border="0" align="bottom" alt="Method: ao/linedetect"></a>&nbsp;&nbsp;&nbsp;<a href="ao_linlsqsvd.html"><img src="../../ug/b_next.gif" border="0" align="bottom" alt="Method: ao/linlsqsvd"></a></td>
      </tr>
    </table>

    <h1 class="title">Method ao/linfit</h1>
    <hr />

<pre>  <SPAN CLASS="HELPTOPIC">LINFIT</SPAN> is a linear fitting tool
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
  DESCRIPTION: <SPAN CLASS="HELPTOPIC">LINFIT</SPAN> is a linear fitting tool based on MATLAB's
  lscov function. It solves an equation in the form
 
      Y = P(1) + X * P(2)
 
  for the fit parameters P.
  The output is a pest object where the fields are containing:
  Quantity                              % Field
  Fit parameters                            y
  Uncertainties on the fit parameters
  (given as standard deviations)            dy
  The reduced CHI2 of the fit              chi2
  The covariance matrix                    cov
  The degrees of freedom of the fit        dof
 
  CALL:       P = <span class="helptopic">linfit</span>(X, Y, PL)
              P = <span class="helptopic">linfit</span>(A, PL)
 
  INPUTS:     Y   - dependent variable
              X   - input variable
              A   - data ao whose x and y fields are used in the fit
              PL  - parameter list
 
  OUTPUT:     P   - a pest object with the fitting coefficients
 
 
  PARAMETERS:
     'dy' - uncertainty on the dependent variable
     'dx' - uncertainties on the input variable
     'p0' - initial guess on the fit parameters used ONLY to propagate
            uncertainities in the input variable X to the dependent variable Y
 
  <a href="ao_linfit.html#down">Parameters Description</a>
 
  EXAMPLES:
 
   %% Make fake AO from polyval
    nsecs = 100;
    fs    = 10;
 
    u1 = unit('fm s^-2');
    u2 = unit('nT');
 
    pl1 = plist('nsecs', nsecs, 'fs', fs, ...
      'tsfcn', 'polyval([10 1], t) + randn(size(t))', ...
      'xunits', 's', 'yunits', u1);
 
    pl2 = plist('nsecs', nsecs, 'fs', fs, ...
      'tsfcn', 'polyval([-5 0.2], t) + randn(size(t))', ...
      'xunits', 's', 'yunits', u2);
 
    a1 = ao(pl1);
    a2 = ao(pl2);
 
   %% 1) Determine dependance from time of a time-series
   %% Fit a stright line the a1 dependance from time
    p1 = <span class="helptopic">linfit</span>(a1, plist());
    p2 = <span class="helptopic">linfit</span>(a1, plist('dx', 0.1*ones(size(a1.x)), 'dy', 0.1*ones(size(a1.y)), 'P0', ao([0 0])));
    p3 = <span class="helptopic">linfit</span>(a1, plist('dx', ao(0.1, plist('yunits', a1.xunits)), 'dy', ao(0.1, plist('yunits', a1.yunits)), 'P0', p1));
 
   %% Compute fit: evaluating pest
 
    b1 = p1.eval(plist('type', 'tsdata', 'XData', a1, 'xfield', 'x'));
    b2 = p2.eval(plist('type', 'tsdata', 'XData', a1.x));
    b3 = p3.eval(plist('type', 'tsdata', 'XData', a1.x));
 
   %% Plot fit
    iplot(a1, b1, b2, b3, plist('LineStyles', {'', '--', ':', '-.'}));
 
   %% Remove linear trend
    c = a1 - b1;
    iplot(c)
 
   %% 2) Determine dependance of a time-series from another time-series
   %% Fit with a straight line the a1 dependance from a2
 
    p1 = <span class="helptopic">linfit</span>(a1, a2, plist());
    p2 = <span class="helptopic">linfit</span>(a1, a2, plist('dx', 0.1*ones(size(a1.x)), 'dy', 0.1*ones(size(a1.x)), 'P0', ao([0 0])));
    p3 = <span class="helptopic">linfit</span>(a1, a2, plist('dx', ao(0.1, plist('yunits', a1.yunits)), 'dy', ao(0.1, plist('yunits', a2.yunits)), 'P0', p1));
 
   %% Compute fit: evaluating pest
 
    b1 = p1.eval(plist('type', 'xydata', 'XData', a1.y, 'xunits', a1.yunits));
    b2 = p2.eval(plist('type', 'xydata', 'XData', a1));
    b3 = p3.eval(plist('type', 'xydata', 'XData', a1.y, 'xunits', a1.yunits));
 
   %% Build reference object
    a12 = ao(plist('xvals', a1.y, 'yvals', a2.y, ...
      'xunits', a1.yunits, 'yunits', a2.yunits));
 
   %% Plot fit
    iplot(a12, b1, b2, b3, plist('LineStyles', {'', '--', ':', '-.'}));
 
    %% Remove linear trend
    c = a12 - b3;
    iplot(c)
 
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</pre>

    <!-- =====        Striped 4x2 table: Begin        ==== -->
    <!-- ===== Created by docHelper.htmlAddStripedTable ===== -->
    <div class="sectiontitle"></div>
    <table cellspacing="0" class="body" cellpadding="2" border="0" width="60%">
      <colgroup>
        <col width="30%"/>
        <col width="70%"/>
      </colgroup>
      <thead>
        <tr valign="top">
          <th class="categorylist">Method Details</th>
          <th class="categorylist"></th>
        </tr>
      </thead>
      <tbody>
        <tr valign="top">
          <td bgcolor="#f3f4f5">Access</td>
          <td bgcolor="#f3f4f5">public</td>
        </tr>
        <tr valign="top">
          <td bgcolor="#ffffff">Defining Class</td>
          <td bgcolor="#ffffff">ao</td>
        </tr>
        <tr valign="top">
          <td bgcolor="#f3f4f5">Sealed</td>
          <td bgcolor="#f3f4f5">0</td>
        </tr>
        <tr valign="top">
          <td bgcolor="#ffffff">Static</td>
          <td bgcolor="#ffffff">0</td>
        </tr>
      </tbody>
    </table>
    <!-- ===== Striped 4x2 table: End ==== -->

    <a name="top_of_page" id="top_of_page"></a>
    <h2>Parameter Description</h2>    <a name="down" id="down"></a>

    <!-- Link-Table of the sets -->
    <table border="0" cellpadding="4" cellspacing="0" class="pagenavtable">
      <tr><th>Sets for this method &#8230;</th></tr>
        <tr><td><a href="#1">Default</a></td></tr>
    </table>

    <a name="1"></a>
    <!-- Parameter List Table: Default -->
    <p>
      <table cellspacing="0" class="body" cellpadding="4" summary="" width="100%" border="2">
        <colgroup>
          <col width="15%"/>
          <col width="20%"/>
          <col width="20%"/>
          <col width="45%"/>
        </colgroup>
        <thead>
        	<tr valign="top">
        		<th bgcolor="#B9C6DD" colspan="4"><h3>Default</h3></th>
      	  </tr>
        	<tr valign="top">
        		<td bgcolor="#B9C6DD" colspan="4"><i>no description</i></td>
      	  </tr>
        	<tr valign="top">
      	  	<th bgcolor="#D7D7D7">Key</th>
        		<th bgcolor="#D7D7D7">Default Value</th>
        		<th bgcolor="#D7D7D7">Options</th>
      	  	<th bgcolor="#D7D7D7">Description</th>
        	</tr>
        </thead>
        <tbody>
          <tr valign="top" ><td align="center" bgcolor="#CCCCFF" colspan="4">linfit</td></tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">DY</td>
            <td bgcolor="#F2F2F2">[]</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">Uncertainty on Y. Can be expressed as<ul><li>an AO with single value or</li><li>an AO with a vector of the right length or</li><li>a double or</li><li>an array of double of the right length</li></ul></td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">DX</td>
            <td bgcolor="#F2F2F2">[]</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">Uncertainty on X(1..N). Can be expressed as<ul><li>an AO with single value or</li><li>an AO with a vector of the right length or</li><li>a double or</li><li>an array of double of the right length</li></ul></td>
          </tr>
          <tr valign="top">
            <td bgcolor="#F2F2F2">P0</td>
            <td bgcolor="#F2F2F2">[]</td>
            <td bgcolor="#F2F2F2"><i>none</i></td>
            <td bgcolor="#F2F2F2">Initial guess of the fit parameters. Can be expressed as:<ul><li>an AOs with a vector</li><li>an array of scalars or</li><li>a pest object</li></ul></td>
          </tr>
        </tbody>
      </table>
      <p>
      <table cellpadding="4">
        <thead>
        	<tr valign="top">
        		<th bgcolor="#FFEE99"><h3>Example</h3></th>
      	  </tr>
        </thead>
        <tbody>
          <tr bgcolor="#FFEE99"><td>plist('DY', [[]], 'DX', [[]], 'P0', [[]])</td></tr>
        </tbody>
      </table>
      </p>
      <!-- ===== Back to top ===== -->
      <a href="#top_of_page">
        <img src="../../ug/doc_to_top_up.gif" border="0" align="bottom" alt="back to top"/>
        back to top
      </a>
    </p>

    <p><!-- Table of the minfo object -->
      <table cellspacing="0" class="body" cellpadding="2" border="0" width="60%">
        <colgroup>
          <col width="25%"/>
          <col width="75%"/>
        </colgroup>
        <thead>
          <tr valign="top">
            <th class="categorylist" colspan="2">Some information of the method ao/linfit are listed below:</th>
          </tr>
        </thead>
        <tbody>
          <!-- Property: 'mclass' -->
          <tr valign="top">
            <td bgcolor="#f3f4f5">Class name</td>
            <td bgcolor="#f3f4f5">ao</td>
          </tr>
          <!-- Property: 'mname' -->
          <tr valign="top">
            <td bgcolor="#ffffff">Method name</td>
            <td bgcolor="#ffffff">linfit</td>
          </tr>
          <!-- Property: 'mcategory' -->
          <tr valign="top">
            <td bgcolor="#f3f4f5">Category</td>
            <td bgcolor="#f3f4f5">Signal Processing</td>
          </tr>
          <!-- Property: 'mpackage' -->
          <tr valign="top">
            <td bgcolor="#ffffff">Package name</td>
            <td bgcolor="#ffffff">ltpda</td>
          </tr>
          <!-- Property: 'modifier' -->
          <tr valign="top">
            <td bgcolor="#f3f4f5">Can be used as modifier</td>
            <td bgcolor="#f3f4f5">0</td>
          </tr>
          <!-- Property: 'supportedNumTypes' -->
          <tr valign="top">
            <td bgcolor="#ffffff">Supported numeric types</td>
            <td bgcolor="#ffffff">{'double'}</td>
          </tr>
        </tbody>
      </table>
    </p>


    <br>
    <br>
    <table class="nav" summary="Navigation aid" border="0" width="100%" cellpadding="0" cellspacing="0">
      <tr valign="top">
        <td align="left" width="20"><a href="ao_linedetect.html"><img src="../../ug/b_prev.gif" border="0" align="bottom" alt="Method: ao/linedetect"></a>&nbsp;</td>
        <td align="left">Method: ao/linedetect</td>
        <td>&nbsp;</td>
        <td align="right">Method: ao/linlsqsvd</td>
        <td align="right" width="20"><a href="ao_linlsqsvd.html"><img src="../../ug/b_next.gif" border="0" align="bottom" alt="Method: ao/linlsqsvd"></a></td>
      </tr>
    </table>

    <br/>
    <p class="copy">&copy;LTP Team</p>

   </body>
</html>
